\documentclass[leqno]{report}
\input{base.tex}
\begin{document}
\author{Chris Wong}
\title{Properties of fast converging Cauchy sequences}
\maketitle

When computing with real numbers, we often use approximate representations such as IEEE-754 floating point. These approximations are efficient and give useful results most of the time.

However, these methods are not without their flaws. It is possible for a handful of floating-point operations to yield a completely incorrect result. For use cases such as computer-assisted proofs, even the slightest chance of error is not acceptable.

TODO something something exact reals

\chapter{Approaches to exact reals}

There are many ways to represent real numbers in a computer program. Some of these methods are outlined below.

\section{Decimal representation}

One naive approach is to represent a real number by a sequence of digits in some base $b$. This base can be any integer greater than 1, but is usually set to 2 or 10. In the latter case, this is our usual \textit{decimal representation}.

Formally, a non-negative real number $r = a_0 . a_1 a_2 a_3 \ldots$ is defined as the sum
\[
    r = \sum_{k=0}^\infty \frac{a_k}{b^{-k}},\quad
\]
where $a_0$ forms the integer part, and $0 \leq a_1, a_2, \ldots < b$ form the fractional part. If the expansion ends in zeroes, then it is said to be \textit{finite}.

While this representation is easy to understand, it has drawbacks that make it hard to use in practice. First, it is not unique: the base-10 expansions $0.999\ldots$ and $1.000\ldots$ are two different representations of 1. Second, the majority of rational numbers do not have finite expansions, one example being $1/3 = 0.333\ldots$.

TODO: explain why decimal representations don't work

\section{Cauchy sequences}

\section{Continued fractions}

\chapter{Fast converging Cauchy sequences}

For the remainder of this thesis, we will discuss \textit{fast converging Cauchy sequences} (\FCCS). These differ from the usual definition in that they must converge exponentially to their limit point. Despite this restriction, \FCCS\ are equivalent to Cauchy sequences, and hence form a model for the (computable) real numbers.

\begin{Definition}
    A fast converging Cauchy sequence (\FCCS) $x : \N \rightarrow \Q$ has the property that
    \[ \fa{m, n \in \N}{ \abs{x_m - x_{m+n}} < \frac{1}{2^m} } \ . \]
\end{Definition}

\begin{Proposition}
    Every fast converging Cauchy sequence is a Cauchy sequence, and vice versa.
\end{Proposition}

\begin{proof}
    ($\Rightarrow$) Let $x$ be a \FCCS, $\varepsilon > 0$ arbitrary. Let $m$ be the least natural number such that $1/2^m \leq \varepsilon$. Then for all $n \in \N$, $\abs{x_m - x_{m+n}} < 1/2^m \leq \varepsilon$.

    ($\Leftarrow$) Let $x$ be a Cauchy sequence. Define $y_m := x_{N(1/2^m)}$ where $N(\varepsilon)$ is the index where all subsequent points differ by less than $\varepsilon$. Then $y$ is a \FCCS.
\end{proof}

\section{Arithmetic and closure properties}

With Cauchy sequences, we define arithmetic operations simply by working pointwise on each element. But with \FCCS, we need to do extra work to preserve the fast convergence property. Take addition, for example: when two approximations are added together, their errors are added as well. In general, this means that the error of the result is \textit{twice} that of the inputs. Hence the addition routine must shift the inputs one step to the right, halving the error to compensate.

\begin{Proposition}[Addition]
    \label{add}
    Let $x, y$ be \FCCS.

    The sum $x + y$, defined by $(x+y)_k := x_{k+1} + y_{k+1}$, is a \FCCS.
\end{Proposition}

\begin{proof}
    Let $m, n \in \N$ be arbitrary.

    Then
    \begin{align*}
        \abs{(x+y)_m - (x+y)_{m+n}}
        &= \abs{(x_{m+1} + y_{m+1}) - (x_{m+n+1} + y_{m+n+1})} \\
        &= \abs{x_{m+1} - x_{m+n+1} + y_{m+1} - y_{m+n+1}} \\
        &\leq \abs{x_{m+1} - x_{m+n+1}} + \abs{y_{m+1} - y_{m+n+1}} \\
        &< \frac{1}{2^{m+1}} + \frac{1}{2^{m+1}} \\
        &= \frac{1}{2^m}
        \ . \qedhere
    \end{align*}
\end{proof}

\begin{Proposition}[Negation]
    \label{neg}
    If $x$ is a \FCCS, then $(-x)_k := -(x_k)$ is a \FCCS.
\end{Proposition}

\begin{proof}
    Let $m, n \in \N$ be arbitrary.

    Then
    \[
        \abs{(-x)_m - (-x)_{m+n}}
        = \abs{-x_m - (-x_{m+n})}
        = \abs{x_m - x_{m+n}}
        < \frac{1}{2^m}
        \ . \qedhere
    \]
\end{proof}

\begin{Corollary}[Subtraction]
    $(x-y)_k := x_{k+1} - y_{k+1}$ is a \FCCS.
\end{Corollary}

Multiplication is more subtle. Unlike with addition, the shift under multiplication is not constant. A larger input would necessitate a larger shift, since the multiplication operation scales the error up by a corresponding amount.

\begin{Proposition}[Multiplication]
    $(xy)_k := x_{a(k)} \cdot y_{b(k)}$ is a \FCCS, where
    \begin{align*}
        a(k) &= k + 1 + \phi(y_0) \\
        b(k) &= k + 1 + \phi(x_0) \\
        \phi(z) &= \max \menge{ 0,\, \left\lceil \log_2(\abs{z} + 1) \right\rceil }
        \ .
    \end{align*}
\end{Proposition}

\begin{proof}
    Given $m, n \in \N$, we need to choose $a,\, b : \N \rightarrow \N$ such that
    \begin{align*}
        \abs{(xy)_m - (xy)_{m+n}}
        &= \abs{x_{a(m)} y_{b(m)} - x_{a(m+n)} y_{b(m+n)}} \\
        &= \abs{x_{a(m)} y_{b(m)} - x_{a(m)} y_{b(m+n)} + x_{a(m)} y_{b(m+n)} - x_{a(m+n)} y_{b(m+n)}} \\
        &\leq \abs{x_{a(m)} y_{b(m)} - x_{a(m)} y_{b(m+n)}} + \abs{x_{a(m)} y_{b(m+n)} - x_{a(m+n)} y_{b(m+n)}} \\
        &= \abs{x_{a(m)}}\abs{y_{b(m)} - y_{b(m+n)}} + \abs{y_{b(m+n)}}\abs{x_{a(m)} - x_{a(m+n)}} \\
        &< \frac{1}{2^m}
        \ .
    \end{align*}

    For this inequality to hold, it is sufficient to show that
    \[ \abs{x_{a(m)}}\abs{y_{b(m)} - y_{b(m+n)}} < \frac{1}{2^{m+1}} \]
    and
    \[ \abs{y_{b(m+n)}}\abs{x_{a(m)} - x_{a(m+n)}} < \frac{1}{2^{m+1}} \ . \]

    To complete the proof, we observe that $\abs{x_{a(m)}} < \abs{x_0} + 1$ and $\phi(x_0) \geq \log_2(\abs{x_0} + 1)$. Using these facts:
    \begin{align*}
        \abs{x_{a(m)}}\abs{y_{b(m)} - y_{b(m+n)}}
        &< (\abs{x_0} + 1) \cdot \frac{1}{2^{b(m)}} \\
        &= \frac{\abs{x_0} + 1}{2^{m + 1 + \phi(x_0)}} \\
        &\leq \frac{\abs{x_0} + 1}{2^{m + 1 + \log_2(\abs{x_0} + 1)}} \\
        &= \frac{\abs{x_0} + 1}{2^{m + 1} \cdot (\abs{x_0} + 1)} \\
        &= \frac{1}{2^{m + 1}}
        \ .
    \end{align*}

    Similarly,
    \begin{align*}
        \abs{y_{a+b}}\abs{x_a - x_{a+b}}
        &< (\abs{y_0} + 1) \cdot \frac{1}{2^{m + 1 + \log_2(\abs{y_0} + 1)}} \\
        &= \frac{1}{2^{m + 1}}
        \ . \qedhere
    \end{align*}
\end{proof}

The definition of the reciprocal is also wonky. TODO commentary

\begin{Definition}[Zero]
    A \FCCS \ $x$ is zero when
    \[ \fa{n \in \N}{\abs{x_n} \leq \frac{1}{2^n}} \ . \]
\end{Definition}

\begin{Lemma}[Apartness] \label{apartness}
    Assume that Markov's principle is true. Then if $x$ is not zero, there exists $c \in \N$ where
    \[ \fa{k \in \N}{\abs{x_{c+k}} > \frac{1}{2^c}} \ . \]
\end{Lemma}

\begin{proof}
    If $x$ is not zero, then by Markov's principle
    \[
        \neg \left( \fa{n \in \N}{\abs{x_n} \leq \frac{1}{2^n}} \right)
        \quad \Rightarrow \quad
        \ex{n \in \N}{\abs{x_n} > \frac{1}{2^n}} \ .
    \]

    Applying the definition of a \FCCS, for all $k \in \N$
    \begin{align*}
        \frac{1}{2^n}
        > \abs{x_n - x_{n+k}}
        \geq \abs{x_n} - \abs{x_{n+k}}
        > \frac{1}{2^n} - \abs{x_{n+k}} \ .
    \end{align*}

    Since $\abs{x_n}$ is rational, we know that
    $\abs{x_n} > 1/2^n \Rightarrow \abs{x_n} = 1/2^n + \varepsilon$
    for some $\varepsilon \in \Q$.

    Therefore
    \[
        \frac{1}{2^n} > \frac{1}{2^n} + \varepsilon - \abs{x_{n+k}}
        \quad \Rightarrow \quad
        \abs{x_{n+k}} > \varepsilon \ .
    \]

    Let $c \geq n$ be the least natural number such that $1/2^c \leq \varepsilon$. Then
    \[ \abs{x_{c+k}} > \varepsilon \geq 1/2^c \ . \qedhere \]
\end{proof}

\begin{Proposition}[Reciprocal]
    Let $x$ be a \FCCS\ which is not zero. Then $\left(x^{-1}\right)_k := \left(x_{k+2c}\right)^{-1}$ is a \FCCS, where $c$ is defined as in Lemma~\ref{apartness}.
\end{Proposition}

\begin{proof}
    By the definition of a \FCCS, we know that
    \[
        \abs{x_{m+2c} - x_{m+n+2c}} < \frac{1}{2^{m+2c}} \ ;
    \]

    And by Lemma~\ref{apartness}, we know that
    \begin{align*}
        \abs{x_{m+2c}} > \frac{1}{2^c} \enspace\wedge\enspace
        \abs{x_{m+n+2c}} > \frac{1}{2^c}
        \enspace&\Rightarrow\enspace
        \abs{x_{m+2c}} \abs{x_{m+n+2c}} > \frac{1}{2^{2c}} \\
        &\Rightarrow\enspace
        \frac{1}{\abs{x_{m+2c}} \abs{x_{m+n+2c}}} < 2^{2c} \ .
    \end{align*}

    Therefore
    \begin{align*}
        \abs{\left(x_{m+2c}\right)^{-1} - \left(x_{m+n+2c}\right)^{-1}}
        &= \abs{\frac{x_{m+2c} - x_{m+n+2c}}{x_{m+2c} \cdot x_{m+n+2c}}} \\
        &= \frac{\abs{x_{m+2c} - x_{m+n+2c}}}{\abs{x_{m+2c}} \abs{x_{m+n+2c}}} \\
        &< \frac{1}{2^{m+2c}} \cdot 2^{2c} \\
        &= \frac{1}{2^m} \ . \qedhere
    \end{align*}
\end{proof}

\begin{Corollary}[Division]
    $(x/y)_k := \left(x \cdot y^{-1}\right)_k$ is a \FCCS.
\end{Corollary}

\section{Exponentials}

With elementary arithmetic under our belt, we can turn our attention to more advanced functions such as the exponential map $\exp(x)$.

Recall that the exponential can be defined as

\[
    \exp(x) = \sum_{n=0}^\infty \frac{x^n}{n!}
    = 1 + x + \frac{x^2}{2} + \frac{x^3}{3!} + \frac{x^4}{4!} + \ldots
\]

In particular, this definition is useful because when $x$ is small, each term is exponentially smaller than the one before it. Hence the sequence of partial sums can be easily adapted to a \FCCS.

\begin{Proposition}[Exponential on {$[-1, 1]$}]
    Let $x$ be a rational number where $-1 \leq x \leq 1$. Then the exponential $\exp_{[-1,1]}(x)$, defined by
    \[
        \left[\exp_{[-1,1]}(x)\right]_n := \sum_{k=0}^{n+1} \frac{x^k}{k!},
    \]
    is a \FCCS.
\end{Proposition}

\begin{proof}
    Let $m, n \in \N$ be arbitrary.

    It can be shown that $k! \leq 2^{k-1}$ for any $k \geq 1$.

    Then
    \begin{align*}
        \abs{\exp_{[-1,1]}(x)_m - \exp_{[-1,1]}(x)_{m+n}}
        &= \abs{\sum_{k=0}^{m+1} \frac{x^k}{k!} - \sum_{k=0}^{m+n+1} \frac{x^k}{k!}} \\
        &= \sum_{k=m+2}^{m+n+1} \frac{\abs{x^k}}{k!} \\
        &\leq \sum_{k=m+2}^{m+n+1} \frac{1}{k!} \\
        &\leq \sum_{k=m+2}^{m+n+1} \frac{1}{2^{k-1}} \\
        &= \sum_{k=m+1}^{m+n} \frac{1}{2^k} \\
        &< \frac{1}{2^m} \ . \qedhere
    \end{align*}
\end{proof}

We can then extend this definition to all rational numbers using the property $\exp(x + y) = \exp(x)\exp(y)$.

\begin{Corollary}[Exponential on $\Q$]
    Let $x$ be a rational number. Then the exponential $\exp(x)$, defined by
    \[
        \exp(x) := \begin{cases}
            \exp_{[-1,1]}(x) & -1 \leq x \leq 1 \\
            \exp(x/2)^2 & \textrm{otherwise}
        \end{cases}
    \]
    is a \FCCS.
\end{Corollary}

\bibliographystyle{abbrv}
\bibliography{All}

\end{document}
